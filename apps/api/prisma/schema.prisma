generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  phoneNumber String @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model UserWorkspaceMembership {
  id        Int      @id @default(autoincrement())
  userId    Int
  workSpaceId Int 
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  workspace      Workspace     @relation(fields: [workSpaceId], references: [id], onDelete: Cascade)

}

model Workspace {
  id        Int      @id @default(autoincrement())
  adminId   Int
  location  String 
}

model Shift {
  id        Int      @id @default(autoincrement())
  startTime DateTime 
  endTime DateTime 
  clockInTime  DateTime @default(null)
  clockOutTime  DateTime @default(null)
  userId Int 
  startBreakTime DateTime @default(null)
  endBreakTime DateTime @default(null)
  breakDuration Int
  workspaceId Int
}

model Role {
  id           Int   @id @default(uuid())
  workspaceId Int
  name   String
  permissions BigInt @default(0)

}

model Permissions {
  bitkey SmallInt
  name String 
  description String
}

model UserRoleMembership {
  id        Int      @id @default(autoincrement())
  userId    Int
  workSpaceId Int 
  roleId Int
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  workspace      Workspace     @relation(fields: [workSpaceId], references: [id], onDelete: Cascade)
  role      Role     @relation(fields: [roleId], references: [id], onDelete: Cascade)
}

model ShiftRequest {
  id        Int      @id @default(autoincrement())
  requestorId Int
  workspaceId Int
  lendedShiftId Int 
  requestedShiftId @default(null)
  status SmallInt 
}

Invitation {
  id        Int      @id @default(uuid())
  workspaceId Int
  expiresAt    DateTime? @db.Timestamptz(6) @default(dbgenerated("now() + interval '1 day'"))
}

model Meeting {
  id        Int      @id @default(autoincrement())
  workspaceId Int
}